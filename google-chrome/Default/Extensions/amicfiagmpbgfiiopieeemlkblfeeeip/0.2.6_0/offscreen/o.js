/*
FunPay Lite Bot
Copyright (c) 2022-2024 Leonid Tsaruk aka NightStranger
Source o.js
Build b92eb51a-59ae-4af0-a7e2-364c0dd4e7da
*/
(()=>{function U(e,r=!1){let t=new Date,o=t.getDate().toString(),n=(t.getMonth()+1).toString(),a=t.getFullYear().toString(),l=t.getHours().toString(),s=t.getMinutes().toString(),i=t.getSeconds().toString();o.toString().length==1&&(o=`0${o}`),n.toString().length==1&&(n=`0${n}`),l.toString().length==1&&(l=`0${l}`),s.toString().length==1&&(s=`0${s}`),i.toString().length==1&&(i=`0${i}`);let c=`>[${o}.${n}.${a}] [${l}:${s}:${i}] >LB: ${e}`;r?console.error(c):console.log(c),typeof e=="object"&&console.log(e)}var m=U;function C(e){let r=/\d+/,t=Number(e.match(r));return isNaN(t)||t==0?null:t}var u=C;function b(e){try{let o=new DOMParser().parseFromString(e,"text/html").querySelectorAll(".promo-game-item"),n=[];for(let a=0;a<o.length;a++)try{let l=o[a],s=l.querySelector(".game-title a"),i=l.querySelectorAll("ul.list-inline"),c=s.innerHTML;for(let f=0;f<i.length;f++){let h=i[f],x=Number(h.dataset.id),y=h.querySelectorAll("li a");for(let d=0;d<y.length;d++){let g=y[d],p="Unknown";g.href.includes("lots")&&(p="lots"),g.href.includes("chips")&&(p="chips");let F=u(g.href),N=g.innerHTML;n.push({game_name:c,node_name:N,node_id:F,game_id:x,type:p})}}}catch(l){m(`Error while getting category: ${l}`)}return n}catch(r){return m("Error in parseAllFunPayCategories:"),m(r),null}}var S=b;function M(e){try{let r=[],n=new DOMParser().parseFromString(e,"text/html").querySelectorAll(".offer-list-title a");for(let a=0;a<n.length;a++){let s=n[a].href;if(s.includes("chips"))continue;let i=u(s);i&&r.push(i)}return r}catch(r){return console.log("Error in parseAllUserCategories:"),console.log(r),null}}var E=M;function T(){return"funpay.com"}var P=T;function w(){return`https://${P()}`}var A=w;function D(e){try{let r=A();return new DOMParser().parseFromString(e,"text/html").querySelector(`a[href="${r}/account/linkTelegram"]`)?.parentElement?.querySelector("b")?.textContent}catch(r){return console.log("Error in parseAllUserCategories:"),console.log(r),null}}var $=D;chrome.runtime.onMessage.addListener(async(e,r,t)=>await L(e,r,t));async function L(e,r,t){if(e.target==="offscreen"){if(e.method=="parseAllFunPayCategories"){let o=S(e.payload.html);t(o)}if(e.method=="parseAllUserCategories"){let o=E(e.payload.html);t(o)}if(e.method=="parseTelegramUsername"){let o=$(e.payload.html);t(o)}}}})();
