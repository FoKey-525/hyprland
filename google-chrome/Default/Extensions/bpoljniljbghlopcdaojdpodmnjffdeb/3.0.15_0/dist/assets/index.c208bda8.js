import{c as commonjsGlobal,b as bridgePopupSandbox,A as ApiEvents,L as LastEvents,a as bridgePopupBackground,u as userStore,U as UserEvents$1,s as setReady,g as generalStore,n as notificationStore,N as NOTIFICATION_DURATION,t as tutorialStore,d as benefitsStore,e as settingsStore,S as SettingsEvents$1,f as defineStore,h as commonjsRequire,i as StorehouseEvents,F as FavouritesEvents}from"./popup.71dac307.js";import{e as existsUser$1,f as findUser$1,r as remove$5,s as save$6}from"./user.c5d689ac.js";import{z as zonesStore}from"./store.57ed1d6b.js";import{f as findByName$1,s as save$7}from"./settings.f1da55bc.js";import{c as connectionStore}from"./store.7bb3311f.js";import"./connection.c490c47b.js";var browserPolyfill={exports:{}};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(module2){var _a,_b;if(!(null==(_b=null==(_a=globalThis.chrome)?void 0:_a.runtime)?void 0:_b.id))throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE="The message port closed before a response was received.",wrapAPIs=extensionAPIs=>{const apiMetadata={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(apiMetadata).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class DefaultWeakMap extends WeakMap{constructor(createItem,items){super(items),this.createItem=createItem}get(key2){return this.has(key2)||this.set(key2,this.createItem(key2)),super.get(key2)}}const isThenable=value=>value&&"object"==typeof value&&"function"==typeof value.then,makeCallback=(promise,metadata)=>(...callbackArgs)=>{extensionAPIs.runtime.lastError?promise.reject(new Error(extensionAPIs.runtime.lastError.message)):metadata.singleCallbackArg||callbackArgs.length<=1&&!1!==metadata.singleCallbackArg?promise.resolve(callbackArgs[0]):promise.resolve(callbackArgs)},pluralizeArguments=numArgs=>1==numArgs?"argument":"arguments",wrapAsyncFunction=(name,metadata)=>function(target,...args){if(args.length<metadata.minArgs)throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);if(args.length>metadata.maxArgs)throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);return new Promise(((resolve,reject)=>{if(metadata.fallbackToNoCallback)try{target[name](...args,makeCallback({resolve:resolve,reject:reject},metadata))}catch(cbError){target[name](...args),metadata.fallbackToNoCallback=!1,metadata.noCallback=!0,resolve()}else metadata.noCallback?(target[name](...args),resolve()):target[name](...args,makeCallback({resolve:resolve,reject:reject},metadata))}))},wrapMethod=(target,method,wrapper)=>new Proxy(method,{apply:(targetMethod,thisObj,args)=>wrapper.call(thisObj,target,...args)});let hasOwnProperty=Function.call.bind(Object.prototype.hasOwnProperty);const wrapObject=(target,wrappers={},metadata={})=>{let cache=Object.create(null),handlers={has:(proxyTarget2,prop)=>prop in target||prop in cache,get(proxyTarget2,prop,receiver){if(prop in cache)return cache[prop];if(!(prop in target))return;let value=target[prop];if("function"==typeof value)if("function"==typeof wrappers[prop])value=wrapMethod(target,target[prop],wrappers[prop]);else if(hasOwnProperty(metadata,prop)){let wrapper=wrapAsyncFunction(prop,metadata[prop]);value=wrapMethod(target,target[prop],wrapper)}else value=value.bind(target);else if("object"==typeof value&&null!==value&&(hasOwnProperty(wrappers,prop)||hasOwnProperty(metadata,prop)))value=wrapObject(value,wrappers[prop],metadata[prop]);else{if(!hasOwnProperty(metadata,"*"))return Object.defineProperty(cache,prop,{configurable:!0,enumerable:!0,get:()=>target[prop],set(value2){target[prop]=value2}}),value;value=wrapObject(value,wrappers[prop],metadata["*"])}return cache[prop]=value,value},set:(proxyTarget2,prop,value,receiver)=>(prop in cache?cache[prop]=value:target[prop]=value,!0),defineProperty:(proxyTarget2,prop,desc)=>Reflect.defineProperty(cache,prop,desc),deleteProperty:(proxyTarget2,prop)=>Reflect.deleteProperty(cache,prop)},proxyTarget=Object.create(target);return new Proxy(proxyTarget,handlers)},wrapEvent=wrapperMap=>({addListener(target,listener,...args){target.addListener(wrapperMap.get(listener),...args)},hasListener:(target,listener)=>target.hasListener(wrapperMap.get(listener)),removeListener(target,listener){target.removeListener(wrapperMap.get(listener))}}),onRequestFinishedWrappers=new DefaultWeakMap((listener=>"function"!=typeof listener?listener:function(req){const wrappedReq=wrapObject(req,{},{getContent:{minArgs:0,maxArgs:0}});listener(wrappedReq)})),onMessageWrappers=new DefaultWeakMap((listener=>"function"!=typeof listener?listener:function(message,sender,sendResponse){let wrappedSendResponse,result,didCallSendResponse=!1,sendResponsePromise=new Promise((resolve=>{wrappedSendResponse=function(response){didCallSendResponse=!0,resolve(response)}}));try{result=listener(message,sender,wrappedSendResponse)}catch(err){result=Promise.reject(err)}const isResultThenable=!0!==result&&isThenable(result);if(!0!==result&&!isResultThenable&&!didCallSendResponse)return!1;const sendPromisedResult=promise=>{promise.then((msg=>{sendResponse(msg)}),(error=>{let message2;message2=error&&(error instanceof Error||"string"==typeof error.message)?error.message:"An unexpected error occurred",sendResponse({__mozWebExtensionPolyfillReject__:!0,message:message2})})).catch((err=>{}))};return sendPromisedResult(isResultThenable?result:sendResponsePromise),!0})),wrappedSendMessageCallback=({reject:reject,resolve:resolve},reply)=>{extensionAPIs.runtime.lastError?extensionAPIs.runtime.lastError.message===CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE?resolve():reject(new Error(extensionAPIs.runtime.lastError.message)):reply&&reply.__mozWebExtensionPolyfillReject__?reject(new Error(reply.message)):resolve(reply)},wrappedSendMessage=(name,metadata,apiNamespaceObj,...args)=>{if(args.length<metadata.minArgs)throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);if(args.length>metadata.maxArgs)throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);return new Promise(((resolve,reject)=>{const wrappedCb=wrappedSendMessageCallback.bind(null,{resolve:resolve,reject:reject});args.push(wrappedCb),apiNamespaceObj.sendMessage(...args)}))},staticWrappers={devtools:{network:{onRequestFinished:wrapEvent(onRequestFinishedWrappers)}},runtime:{onMessage:wrapEvent(onMessageWrappers),onMessageExternal:wrapEvent(onMessageWrappers),sendMessage:wrappedSendMessage.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:wrappedSendMessage.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},settingMetadata={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return apiMetadata.privacy={network:{"*":settingMetadata},services:{"*":settingMetadata},websites:{"*":settingMetadata}},wrapObject(extensionAPIs,staticWrappers,apiMetadata)};module2.exports=wrapAPIs(chrome)}else module2.exports=globalThis.browser}(browserPolyfill);var browser=browserPolyfill.exports;bridgePopupSandbox.on(ApiEvents.GetUILanguage.Name,(()=>browser.i18n.getUILanguage()));const findLast=()=>(async()=>bridgePopupSandbox.emit(LastEvents.FindLast.Name))(),remove$3=value=>(async value=>bridgePopupSandbox.emit(LastEvents.Remove.Name,{value:value}))(value),save$4=value=>(async value=>bridgePopupSandbox.emit(LastEvents.Save.Name,{value:value}))(value);var SettingsEvents,SettingsEvents2,GeneralEvents,GeneralEvents2,UserEvents,UserEvents2,ZonesEvents,ZonesEvents2,ConnectionEvents,ConnectionEvents2,MessagesEvents,MessagesEvents2,PrepareEvents,PrepareEvents2,TutorialEvents,TutorialEvents2,BenefitsEvents,BenefitsEvents2;bridgePopupBackground.on(LastEvents.FindLast.Name,(()=>findLast())),bridgePopupBackground.on(LastEvents.Remove.Name,(({value:value})=>remove$3(value))),bridgePopupBackground.on(LastEvents.Save.Name,(({value:value})=>save$4(value))),((SettingsEvents2=SettingsEvents||(SettingsEvents={})).SetLanguage||(SettingsEvents2.SetLanguage={})).Name="settings-set-language",(SettingsEvents2.SetCustomServer||(SettingsEvents2.SetCustomServer={})).Name="settings-set-server",(SettingsEvents2.SetCustomServerError||(SettingsEvents2.SetCustomServerError={})).Name="settings-set-server-error",((GeneralEvents2=GeneralEvents||(GeneralEvents={})).SetRoute||(GeneralEvents2.SetRoute={})).Name="general-set-route",(GeneralEvents2.AddNotification||(GeneralEvents2.AddNotification={})).Name="general-add-notification",((UserEvents2=UserEvents||(UserEvents={})).SetLicenseKey||(UserEvents2.SetLicenseKey={})).Name="user-set-license-key",(UserEvents2.SetSubscription||(UserEvents2.SetSubscription={})).Name="user-set-subscription",(UserEvents2.SetReceivingCode||(UserEvents2.SetReceivingCode={})).Name="user-set-receiving-code",(UserEvents2.SetDepartureCode||(UserEvents2.SetDepartureCode={})).Name="user-set-departure-code",(UserEvents2.SetEmail||(UserEvents2.SetEmail={})).Name="user-set-email",((ZonesEvents2=ZonesEvents||(ZonesEvents={})).SetZones||(ZonesEvents2.SetZones={})).Name="zones-set-zones",(ZonesEvents2.SetFavourites||(ZonesEvents2.SetFavourites={})).Name="zones-set-favourites",(ZonesEvents2.SetLast||(ZonesEvents2.SetLast={})).Name="zones-set-last",((ConnectionEvents2=ConnectionEvents||(ConnectionEvents={})).SetActive||(ConnectionEvents2.SetActive={})).Name="connection-set-active",(ConnectionEvents2.SetHost||(ConnectionEvents2.SetHost={})).Name="connection-set-host",((MessagesEvents2=MessagesEvents||(MessagesEvents={})).SetMessages||(MessagesEvents2.SetMessages={})).Name="messages-set-messages",((PrepareEvents2=PrepareEvents||(PrepareEvents={})).Ready||(PrepareEvents2.Ready={})).Name="prepare-ready",((TutorialEvents2=TutorialEvents||(TutorialEvents={})).Open||(TutorialEvents2.Open={})).Name="tutorial-open",((BenefitsEvents2=BenefitsEvents||(BenefitsEvents={})).Open||(BenefitsEvents2.Open={})).Name="benefits-open",(BenefitsEvents2.Close||(BenefitsEvents2.Close={})).Name="benefits-close";const user=userStore();bridgePopupBackground.on(UserEvents.SetLicenseKey.Name,(({value:value})=>function(value){user.setLicenseKey(value)}(value))),bridgePopupBackground.on(UserEvents.SetSubscription.Name,(({value:value})=>function(value){user.setSubscription(value)}(value))),bridgePopupBackground.on(UserEvents.SetReceivingCode.Name,(({value:value})=>function(value){user.setReceivingCode(value)}(value))),bridgePopupBackground.on(UserEvents.SetDepartureCode.Name,(({value:value})=>function(value){user.setDepartureCode(value)}(value))),bridgePopupBackground.on(UserEvents.SetEmail.Name,(({value:value})=>function(value){user.setEmail(value)}(value))),bridgePopupBackground.on(UserEvents$1.ExistsUser.Name,(()=>existsUser$1())),bridgePopupBackground.on(UserEvents$1.FindUser.Name,(()=>findUser$1())),bridgePopupBackground.on(UserEvents$1.Remove.Name,(({value:value})=>(value=>remove$5(value))(value))),bridgePopupBackground.on(UserEvents$1.Save.Name,(({value:value})=>(value=>save$6(value))(value)));const zones=zonesStore();bridgePopupBackground.on(ZonesEvents.SetZones.Name,(({value:value})=>function(value){zones.updateServers(value)}(value))),bridgePopupBackground.on(ZonesEvents.SetFavourites.Name,(({value:value})=>function(value){zones.updateFavourites(value)}(value))),bridgePopupBackground.on(ZonesEvents.SetLast.Name,(({value:value})=>function(value){zones.setLast(value)}(value)));bridgePopupSandbox.on(PrepareEvents.Ready.Name,(()=>setReady(!0)));const general=generalStore(),notification=notificationStore();bridgePopupBackground.on(GeneralEvents.SetRoute.Name,(({value:value})=>function(value){general.setRoute(value)}(value))),bridgePopupBackground.on(GeneralEvents.AddNotification.Name,(({type:type,id:id,translate:translate,duration:duration})=>function(type,id,translate=!0,duration=NOTIFICATION_DURATION){notification.add(type,id,translate,duration)}(type,id,translate,duration)));const tutorial=tutorialStore();bridgePopupBackground.on(TutorialEvents.Open.Name,(()=>{tutorial.open()}));const benefits=benefitsStore();bridgePopupBackground.on(BenefitsEvents.Open.Name,(()=>{benefits.open()})),bridgePopupBackground.on(BenefitsEvents.Close.Name,(()=>{benefits.close()}));const settings=settingsStore();bridgePopupBackground.on(SettingsEvents.SetLanguage.Name,(({value:value})=>function(value){settings.setLanguage(value)}(value))),bridgePopupBackground.on(SettingsEvents.SetCustomServer.Name,(({value:value})=>function(value){settings.setCustomServerValue(value)}(value))),bridgePopupBackground.on(SettingsEvents.SetCustomServerError.Name,(({value:value=null})=>function(value=null){settings.setCustomServerError(value)}(value))),bridgePopupBackground.on(SettingsEvents$1.FindByName.Name,(({value:value})=>(value=>findByName$1(value))(value))),bridgePopupBackground.on(SettingsEvents$1.Save.Name,(({value:value})=>(value=>save$7(value))(value)));const messages=defineStore({id:"messagesStore",state:()=>({data:{}}),actions:{setData(value){this.data=value}}})();bridgePopupBackground.on(MessagesEvents.SetMessages.Name,(({value:value})=>function(value){messages.setData(value)}(value)));var localforage$1={exports:{}},localforage=localforage$1.exports=function e(t,n,r){function s(o2,u){if(!n[o2]){if(!t[o2]){var a="function"==typeof commonjsRequire&&commonjsRequire;if(!u&&a)return a(o2,!0);if(i)return i(o2,!0);var f=new Error("Cannot find module '"+o2+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o2]={exports:{}};t[o2][0].call(l.exports,(function(e2){var n2=t[o2][1][e2];return s(n2||e2)}),l,l.exports,e,t,n,r)}return n[o2].exports}for(var i="function"==typeof commonjsRequire&&commonjsRequire,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module2,exports2){(function(global){var scheduleDrain,draining,Mutation=global.MutationObserver||global.WebKitMutationObserver;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||void 0===global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var scriptEl=global.document.createElement("script");scriptEl.onreadystatechange=function(){nextTick(),scriptEl.onreadystatechange=null,scriptEl.parentNode.removeChild(scriptEl),scriptEl=null},global.document.documentElement.appendChild(scriptEl)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var queue=[];function nextTick(){var i,oldQueue;draining=!0;for(var len=queue.length;len;){for(oldQueue=queue,queue=[],i=-1;++i<len;)oldQueue[i]();len=queue.length}draining=!1}function immediate(task){1!==queue.push(task)||draining||scheduleDrain()}module2.exports=immediate}).call(this,void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(_dereq_,module2,exports2){var immediate=_dereq_(1);function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];function Promise2(resolver){if("function"!=typeof resolver)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,resolver!==INTERNAL&&safelyResolveThenable(this,resolver)}function QueueItem(promise,onFulfilled,onRejected){this.promise=promise,"function"==typeof onFulfilled&&(this.onFulfilled=onFulfilled,this.callFulfilled=this.otherCallFulfilled),"function"==typeof onRejected&&(this.onRejected=onRejected,this.callRejected=this.otherCallRejected)}function unwrap(promise,func,value){immediate((function(){var returnValue;try{returnValue=func(value)}catch(e){return handlers.reject(promise,e)}returnValue===promise?handlers.reject(promise,new TypeError("Cannot resolve promise with itself")):handlers.resolve(promise,returnValue)}))}function getThen(obj){var then=obj&&obj.then;if(obj&&("object"==typeof obj||"function"==typeof obj)&&"function"==typeof then)return function(){then.apply(obj,arguments)}}function safelyResolveThenable(self2,thenable){var called=!1;function onError(value){called||(called=!0,handlers.reject(self2,value))}function onSuccess(value){called||(called=!0,handlers.resolve(self2,value))}function tryToUnwrap(){thenable(onSuccess,onError)}var result=tryCatch(tryToUnwrap);"error"===result.status&&onError(result.value)}function tryCatch(func,value){var out={};try{out.value=func(value),out.status="success"}catch(e){out.status="error",out.value=e}return out}function resolve(value){return value instanceof this?value:handlers.resolve(new this(INTERNAL),value)}function reject(reason){var promise=new this(INTERNAL);return handlers.reject(promise,reason)}function all(iterable){var self2=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var values=new Array(len),resolved=0,i=-1,promise=new this(INTERNAL);++i<len;)allResolver(iterable[i],i);return promise;function allResolver(value,i2){function resolveFromAll(outValue){values[i2]=outValue,++resolved!==len||called||(called=!0,handlers.resolve(promise,values))}self2.resolve(value).then(resolveFromAll,(function(error){called||(called=!0,handlers.reject(promise,error))}))}}function race(iterable){var self2=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var i=-1,promise=new this(INTERNAL);++i<len;)resolver(iterable[i]);return promise;function resolver(value){self2.resolve(value).then((function(response){called||(called=!0,handlers.resolve(promise,response))}),(function(error){called||(called=!0,handlers.reject(promise,error))}))}}module2.exports=Promise2,Promise2.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise2.prototype.then=function(onFulfilled,onRejected){if("function"!=typeof onFulfilled&&this.state===FULFILLED||"function"!=typeof onRejected&&this.state===REJECTED)return this;var promise=new this.constructor(INTERNAL);return this.state!==PENDING?unwrap(promise,this.state===FULFILLED?onFulfilled:onRejected,this.outcome):this.queue.push(new QueueItem(promise,onFulfilled,onRejected)),promise},QueueItem.prototype.callFulfilled=function(value){handlers.resolve(this.promise,value)},QueueItem.prototype.otherCallFulfilled=function(value){unwrap(this.promise,this.onFulfilled,value)},QueueItem.prototype.callRejected=function(value){handlers.reject(this.promise,value)},QueueItem.prototype.otherCallRejected=function(value){unwrap(this.promise,this.onRejected,value)},handlers.resolve=function(self2,value){var result=tryCatch(getThen,value);if("error"===result.status)return handlers.reject(self2,result.value);var thenable=result.value;if(thenable)safelyResolveThenable(self2,thenable);else{self2.state=FULFILLED,self2.outcome=value;for(var i=-1,len=self2.queue.length;++i<len;)self2.queue[i].callFulfilled(value)}return self2},handlers.reject=function(self2,error){self2.state=REJECTED,self2.outcome=error;for(var i=-1,len=self2.queue.length;++i<len;)self2.queue[i].callRejected(error);return self2},Promise2.resolve=resolve,Promise2.reject=reject,Promise2.all=all,Promise2.race=race},{1:1}],3:[function(_dereq_,module2,exports2){(function(global){"function"!=typeof global.Promise&&(global.Promise=_dereq_(2))}).call(this,void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(_dereq_,module2,exports2){var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function getIDB(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var idb=getIDB();function isIndexedDBValid(){try{if(!idb||!idb.open)return!1;var isSafari="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),hasFetch="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!isSafari||hasFetch)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function createBlob(parts,properties){parts=parts||[],properties=properties||{};try{return new Blob(parts,properties)}catch(e){if("TypeError"!==e.name)throw e;for(var builder=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<parts.length;i+=1)builder.append(parts[i]);return builder.getBlob(properties.type)}}"undefined"==typeof Promise&&_dereq_(3);var Promise$1=Promise;function executeCallback(promise,callback){callback&&promise.then((function(result){callback(null,result)}),(function(error){callback(error)}))}function executeTwoCallbacks(promise,callback,errorCallback){"function"==typeof callback&&promise.then(callback),"function"==typeof errorCallback&&promise.catch(errorCallback)}function normalizeKey(key3){return"string"!=typeof key3&&(key3=String(key3)),key3}function getCallback(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var DETECT_BLOB_SUPPORT_STORE="local-forage-detect-blob-support",supportsBlobs=void 0,dbContexts={},toString=Object.prototype.toString,READ_ONLY="readonly",READ_WRITE="readwrite";function _binStringToArrayBuffer(bin){for(var length3=bin.length,buf=new ArrayBuffer(length3),arr=new Uint8Array(buf),i=0;i<length3;i++)arr[i]=bin.charCodeAt(i);return buf}function _checkBlobSupportWithoutCaching(idb2){return new Promise$1((function(resolve){var txn=idb2.transaction(DETECT_BLOB_SUPPORT_STORE,READ_WRITE),blob=createBlob([""]);txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob,"key"),txn.onabort=function(e){e.preventDefault(),e.stopPropagation(),resolve(!1)},txn.oncomplete=function(){var matchedChrome=navigator.userAgent.match(/Chrome\/(\d+)/),matchedEdge=navigator.userAgent.match(/Edge\//);resolve(matchedEdge||!matchedChrome||parseInt(matchedChrome[1],10)>=43)}})).catch((function(){return!1}))}function _checkBlobSupport(idb2){return"boolean"==typeof supportsBlobs?Promise$1.resolve(supportsBlobs):_checkBlobSupportWithoutCaching(idb2).then((function(value){return supportsBlobs=value}))}function _deferReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name],deferredOperation={};deferredOperation.promise=new Promise$1((function(resolve,reject){deferredOperation.resolve=resolve,deferredOperation.reject=reject})),dbContext.deferredOperations.push(deferredOperation),dbContext.dbReady?dbContext.dbReady=dbContext.dbReady.then((function(){return deferredOperation.promise})):dbContext.dbReady=deferredOperation.promise}function _advanceReadiness(dbInfo){var deferredOperation=dbContexts[dbInfo.name].deferredOperations.pop();if(deferredOperation)return deferredOperation.resolve(),deferredOperation.promise}function _rejectReadiness(dbInfo,err){var deferredOperation=dbContexts[dbInfo.name].deferredOperations.pop();if(deferredOperation)return deferredOperation.reject(err),deferredOperation.promise}function _getConnection(dbInfo,upgradeNeeded){return new Promise$1((function(resolve,reject){if(dbContexts[dbInfo.name]=dbContexts[dbInfo.name]||createDbContext(),dbInfo.db){if(!upgradeNeeded)return resolve(dbInfo.db);_deferReadiness(dbInfo),dbInfo.db.close()}var dbArgs=[dbInfo.name];upgradeNeeded&&dbArgs.push(dbInfo.version);var openreq=idb.open.apply(idb,dbArgs);upgradeNeeded&&(openreq.onupgradeneeded=function(e){var db=openreq.result;try{db.createObjectStore(dbInfo.storeName),e.oldVersion<=1&&db.createObjectStore(DETECT_BLOB_SUPPORT_STORE)}catch(ex){if("ConstraintError"!==ex.name)throw ex}}),openreq.onerror=function(e){e.preventDefault(),reject(openreq.error)},openreq.onsuccess=function(){var db=openreq.result;db.onversionchange=function(e){e.target.close()},resolve(db),_advanceReadiness(dbInfo)}}))}function _getOriginalConnection(dbInfo){return _getConnection(dbInfo,!1)}function _getUpgradedConnection(dbInfo){return _getConnection(dbInfo,!0)}function _isUpgradeNeeded(dbInfo,defaultVersion){if(!dbInfo.db)return!0;var isNewStore=!dbInfo.db.objectStoreNames.contains(dbInfo.storeName),isDowngrade=dbInfo.version<dbInfo.db.version,isUpgrade=dbInfo.version>dbInfo.db.version;if(isDowngrade&&(dbInfo.version,dbInfo.version=dbInfo.db.version),isUpgrade||isNewStore){if(isNewStore){var incVersion=dbInfo.db.version+1;incVersion>dbInfo.version&&(dbInfo.version=incVersion)}return!0}return!1}function _encodeBlob(blob){return new Promise$1((function(resolve,reject){var reader=new FileReader;reader.onerror=reject,reader.onloadend=function(e){var base64=btoa(e.target.result||"");resolve({__local_forage_encoded_blob:!0,data:base64,type:blob.type})},reader.readAsBinaryString(blob)}))}function _decodeBlob(encodedBlob){return createBlob([_binStringToArrayBuffer(atob(encodedBlob.data))],{type:encodedBlob.type})}function _isEncodedBlob(value){return value&&value.__local_forage_encoded_blob}function _fullyReady(callback){var self2=this,promise=self2._initReady().then((function(){var dbContext=dbContexts[self2._dbInfo.name];if(dbContext&&dbContext.dbReady)return dbContext.dbReady}));return executeTwoCallbacks(promise,callback,callback),promise}function _tryReconnect(dbInfo){_deferReadiness(dbInfo);for(var dbContext=dbContexts[dbInfo.name],forages=dbContext.forages,i=0;i<forages.length;i++){var forage=forages[i];forage._dbInfo.db&&(forage._dbInfo.db.close(),forage._dbInfo.db=null)}return dbInfo.db=null,_getOriginalConnection(dbInfo).then((function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo)?_getUpgradedConnection(dbInfo):db})).then((function(db){dbInfo.db=dbContext.db=db;for(var i2=0;i2<forages.length;i2++)forages[i2]._dbInfo.db=db})).catch((function(err){throw _rejectReadiness(dbInfo,err),err}))}function createTransaction(dbInfo,mode,callback,retries){void 0===retries&&(retries=1);try{var tx=dbInfo.db.transaction(dbInfo.storeName,mode);callback(null,tx)}catch(err){if(retries>0&&(!dbInfo.db||"InvalidStateError"===err.name||"NotFoundError"===err.name))return Promise$1.resolve().then((function(){if(!dbInfo.db||"NotFoundError"===err.name&&!dbInfo.db.objectStoreNames.contains(dbInfo.storeName)&&dbInfo.version<=dbInfo.db.version)return dbInfo.db&&(dbInfo.version=dbInfo.db.version+1),_getUpgradedConnection(dbInfo)})).then((function(){return _tryReconnect(dbInfo).then((function(){createTransaction(dbInfo,mode,callback,retries-1)}))})).catch(callback);callback(err)}}function createDbContext(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function _initStorage(options){var self2=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]=options[i];var dbContext=dbContexts[dbInfo.name];dbContext||(dbContext=createDbContext(),dbContexts[dbInfo.name]=dbContext),dbContext.forages.push(self2),self2._initReady||(self2._initReady=self2.ready,self2.ready=_fullyReady);var initPromises=[];function ignoreErrors(){return Promise$1.resolve()}for(var j=0;j<dbContext.forages.length;j++){var forage=dbContext.forages[j];forage!==self2&&initPromises.push(forage._initReady().catch(ignoreErrors))}var forages=dbContext.forages.slice(0);return Promise$1.all(initPromises).then((function(){return dbInfo.db=dbContext.db,_getOriginalConnection(dbInfo)})).then((function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo,self2._defaultConfig.version)?_getUpgradedConnection(dbInfo):db})).then((function(db){dbInfo.db=dbContext.db=db,self2._dbInfo=dbInfo;for(var k=0;k<forages.length;k++){var forage2=forages[k];forage2!==self2&&(forage2._dbInfo.db=dbInfo.db,forage2._dbInfo.version=dbInfo.version)}}))}function getItem2(key3,callback){var self2=this;key3=normalizeKey(key3);var promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){createTransaction(self2._dbInfo,READ_ONLY,(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self2._dbInfo.storeName).get(key3);req.onsuccess=function(){var value=req.result;void 0===value&&(value=null),_isEncodedBlob(value)&&(value=_decodeBlob(value)),resolve(value)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise}function iterate2(iterator,callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){createTransaction(self2._dbInfo,READ_ONLY,(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self2._dbInfo.storeName).openCursor(),iterationNumber=1;req.onsuccess=function(){var cursor=req.result;if(cursor){var value=cursor.value;_isEncodedBlob(value)&&(value=_decodeBlob(value));var result=iterator(value,cursor.key,iterationNumber++);void 0!==result?resolve(result):cursor.continue()}else resolve()},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise}function setItem2(key3,value,callback){var self2=this;key3=normalizeKey(key3);var promise=new Promise$1((function(resolve,reject){var dbInfo;self2.ready().then((function(){return dbInfo=self2._dbInfo,"[object Blob]"===toString.call(value)?_checkBlobSupport(dbInfo.db).then((function(blobSupport){return blobSupport?value:_encodeBlob(value)})):value})).then((function(value2){createTransaction(self2._dbInfo,READ_WRITE,(function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self2._dbInfo.storeName);null===value2&&(value2=void 0);var req=store.put(value2,key3);transaction.oncomplete=function(){void 0===value2&&(value2=null),resolve(value2)},transaction.onabort=transaction.onerror=function(){var err2=req.error?req.error:req.transaction.error;reject(err2)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise}function removeItem2(key3,callback){var self2=this;key3=normalizeKey(key3);var promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){createTransaction(self2._dbInfo,READ_WRITE,(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self2._dbInfo.storeName).delete(key3);transaction.oncomplete=function(){resolve()},transaction.onerror=function(){reject(req.error)},transaction.onabort=function(){var err2=req.error?req.error:req.transaction.error;reject(err2)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise}function clear2(callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){createTransaction(self2._dbInfo,READ_WRITE,(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self2._dbInfo.storeName).clear();transaction.oncomplete=function(){resolve()},transaction.onabort=transaction.onerror=function(){var err2=req.error?req.error:req.transaction.error;reject(err2)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise}function length2(callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){createTransaction(self2._dbInfo,READ_ONLY,(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self2._dbInfo.storeName).count();req.onsuccess=function(){resolve(req.result)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise}function key2(n,callback){var self2=this,promise=new Promise$1((function(resolve,reject){n<0?resolve(null):self2.ready().then((function(){createTransaction(self2._dbInfo,READ_ONLY,(function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self2._dbInfo.storeName),advanced=!1,req=store.openKeyCursor();req.onsuccess=function(){var cursor=req.result;cursor?0===n||advanced?resolve(cursor.key):(advanced=!0,cursor.advance(n)):resolve(null)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise}function keys2(callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){createTransaction(self2._dbInfo,READ_ONLY,(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self2._dbInfo.storeName).openKeyCursor(),keys3=[];req.onsuccess=function(){var cursor=req.result;cursor?(keys3.push(cursor.key),cursor.continue()):resolve(keys3)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise}function dropInstance(options,callback){callback=getCallback.apply(this,arguments);var currentConfig=this.config();(options="function"!=typeof options&&options||{}).name||(options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName);var promise,self2=this;if(options.name){var dbPromise=options.name===currentConfig.name&&self2._dbInfo.db?Promise$1.resolve(self2._dbInfo.db):_getOriginalConnection(options).then((function(db){var dbContext=dbContexts[options.name],forages=dbContext.forages;dbContext.db=db;for(var i=0;i<forages.length;i++)forages[i]._dbInfo.db=db;return db}));promise=options.storeName?dbPromise.then((function(db){if(db.objectStoreNames.contains(options.storeName)){var newVersion=db.version+1;_deferReadiness(options);var dbContext=dbContexts[options.name],forages=dbContext.forages;db.close();for(var i=0;i<forages.length;i++){var forage=forages[i];forage._dbInfo.db=null,forage._dbInfo.version=newVersion}return new Promise$1((function(resolve,reject){var req=idb.open(options.name,newVersion);req.onerror=function(err){req.result.close(),reject(err)},req.onupgradeneeded=function(){req.result.deleteObjectStore(options.storeName)},req.onsuccess=function(){var db2=req.result;db2.close(),resolve(db2)}})).then((function(db2){dbContext.db=db2;for(var j=0;j<forages.length;j++){var _forage2=forages[j];_forage2._dbInfo.db=db2,_advanceReadiness(_forage2._dbInfo)}})).catch((function(err){throw(_rejectReadiness(options,err)||Promise$1.resolve()).catch((function(){})),err}))}})):dbPromise.then((function(db){_deferReadiness(options);var dbContext=dbContexts[options.name],forages=dbContext.forages;db.close();for(var i=0;i<forages.length;i++)forages[i]._dbInfo.db=null;return new Promise$1((function(resolve,reject){var req=idb.deleteDatabase(options.name);req.onerror=function(){var db2=req.result;db2&&db2.close(),reject(req.error)},req.onblocked=function(){},req.onsuccess=function(){var db2=req.result;db2&&db2.close(),resolve(db2)}})).then((function(db2){dbContext.db=db2;for(var i2=0;i2<forages.length;i2++)_advanceReadiness(forages[i2]._dbInfo)})).catch((function(err){throw(_rejectReadiness(options,err)||Promise$1.resolve()).catch((function(){})),err}))}))}else promise=Promise$1.reject("Invalid arguments");return executeCallback(promise,callback),promise}var asyncStorage={_driver:"asyncStorage",_initStorage:_initStorage,_support:isIndexedDBValid(),iterate:iterate2,getItem:getItem2,setItem:setItem2,removeItem:removeItem2,clear:clear2,length:length2,key:key2,keys:keys2,dropInstance:dropInstance};function isWebSQLValid(){return"function"==typeof openDatabase}var BASE_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BLOB_TYPE_PREFIX="~~local_forage_type~",BLOB_TYPE_PREFIX_REGEX=/^~~local_forage_type~([^~]+)~/,SERIALIZED_MARKER="__lfsc__:",SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER.length,TYPE_ARRAYBUFFER="arbf",TYPE_BLOB="blob",TYPE_INT8ARRAY="si08",TYPE_UINT8ARRAY="ui08",TYPE_UINT8CLAMPEDARRAY="uic8",TYPE_INT16ARRAY="si16",TYPE_INT32ARRAY="si32",TYPE_UINT16ARRAY="ur16",TYPE_UINT32ARRAY="ui32",TYPE_FLOAT32ARRAY="fl32",TYPE_FLOAT64ARRAY="fl64",TYPE_SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER_LENGTH+TYPE_ARRAYBUFFER.length,toString$1=Object.prototype.toString;function stringToBuffer(serializedString){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*serializedString.length,len=serializedString.length,p=0;"="===serializedString[serializedString.length-1]&&(bufferLength--,"="===serializedString[serializedString.length-2]&&bufferLength--);var buffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(buffer);for(i=0;i<len;i+=4)encoded1=BASE_CHARS.indexOf(serializedString[i]),encoded2=BASE_CHARS.indexOf(serializedString[i+1]),encoded3=BASE_CHARS.indexOf(serializedString[i+2]),encoded4=BASE_CHARS.indexOf(serializedString[i+3]),bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return buffer}function bufferToString(buffer){var i,bytes=new Uint8Array(buffer),base64String="";for(i=0;i<bytes.length;i+=3)base64String+=BASE_CHARS[bytes[i]>>2],base64String+=BASE_CHARS[(3&bytes[i])<<4|bytes[i+1]>>4],base64String+=BASE_CHARS[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64String+=BASE_CHARS[63&bytes[i+2]];return bytes.length%3==2?base64String=base64String.substring(0,base64String.length-1)+"=":bytes.length%3==1&&(base64String=base64String.substring(0,base64String.length-2)+"=="),base64String}function serialize(value,callback){var valueType="";if(value&&(valueType=toString$1.call(value)),value&&("[object ArrayBuffer]"===valueType||value.buffer&&"[object ArrayBuffer]"===toString$1.call(value.buffer))){var buffer,marker=SERIALIZED_MARKER;value instanceof ArrayBuffer?(buffer=value,marker+=TYPE_ARRAYBUFFER):(buffer=value.buffer,"[object Int8Array]"===valueType?marker+=TYPE_INT8ARRAY:"[object Uint8Array]"===valueType?marker+=TYPE_UINT8ARRAY:"[object Uint8ClampedArray]"===valueType?marker+=TYPE_UINT8CLAMPEDARRAY:"[object Int16Array]"===valueType?marker+=TYPE_INT16ARRAY:"[object Uint16Array]"===valueType?marker+=TYPE_UINT16ARRAY:"[object Int32Array]"===valueType?marker+=TYPE_INT32ARRAY:"[object Uint32Array]"===valueType?marker+=TYPE_UINT32ARRAY:"[object Float32Array]"===valueType?marker+=TYPE_FLOAT32ARRAY:"[object Float64Array]"===valueType?marker+=TYPE_FLOAT64ARRAY:callback(new Error("Failed to get type for BinaryArray"))),callback(marker+bufferToString(buffer))}else if("[object Blob]"===valueType){var fileReader=new FileReader;fileReader.onload=function(){var str=BLOB_TYPE_PREFIX+value.type+"~"+bufferToString(this.result);callback(SERIALIZED_MARKER+TYPE_BLOB+str)},fileReader.readAsArrayBuffer(value)}else try{callback(JSON.stringify(value))}catch(e){callback(null,e)}}function deserialize(value){if(value.substring(0,SERIALIZED_MARKER_LENGTH)!==SERIALIZED_MARKER)return JSON.parse(value);var blobType,serializedString=value.substring(TYPE_SERIALIZED_MARKER_LENGTH),type=value.substring(SERIALIZED_MARKER_LENGTH,TYPE_SERIALIZED_MARKER_LENGTH);if(type===TYPE_BLOB&&BLOB_TYPE_PREFIX_REGEX.test(serializedString)){var matcher=serializedString.match(BLOB_TYPE_PREFIX_REGEX);blobType=matcher[1],serializedString=serializedString.substring(matcher[0].length)}var buffer=stringToBuffer(serializedString);switch(type){case TYPE_ARRAYBUFFER:return buffer;case TYPE_BLOB:return createBlob([buffer],{type:blobType});case TYPE_INT8ARRAY:return new Int8Array(buffer);case TYPE_UINT8ARRAY:return new Uint8Array(buffer);case TYPE_UINT8CLAMPEDARRAY:return new Uint8ClampedArray(buffer);case TYPE_INT16ARRAY:return new Int16Array(buffer);case TYPE_UINT16ARRAY:return new Uint16Array(buffer);case TYPE_INT32ARRAY:return new Int32Array(buffer);case TYPE_UINT32ARRAY:return new Uint32Array(buffer);case TYPE_FLOAT32ARRAY:return new Float32Array(buffer);case TYPE_FLOAT64ARRAY:return new Float64Array(buffer);default:throw new Error("Unkown type: "+type)}}var localforageSerializer={serialize:serialize,deserialize:deserialize,stringToBuffer:stringToBuffer,bufferToString:bufferToString};function createDbTable(t,dbInfo,callback,errorCallback){t.executeSql("CREATE TABLE IF NOT EXISTS "+dbInfo.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],callback,errorCallback)}function _initStorage$1(options){var self2=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]="string"!=typeof options[i]?options[i].toString():options[i];var dbInfoPromise=new Promise$1((function(resolve,reject){try{dbInfo.db=openDatabase(dbInfo.name,String(dbInfo.version),dbInfo.description,dbInfo.size)}catch(e){return reject(e)}dbInfo.db.transaction((function(t){createDbTable(t,dbInfo,(function(){self2._dbInfo=dbInfo,resolve()}),(function(t2,error){reject(error)}))}),reject)}));return dbInfo.serializer=localforageSerializer,dbInfoPromise}function tryExecuteSql(t,dbInfo,sqlStatement,args,callback,errorCallback){t.executeSql(sqlStatement,args,callback,(function(t2,error){error.code===error.SYNTAX_ERR?t2.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[dbInfo.storeName],(function(t3,results){results.rows.length?errorCallback(t3,error):createDbTable(t3,dbInfo,(function(){t3.executeSql(sqlStatement,args,callback,errorCallback)}),errorCallback)}),errorCallback):errorCallback(t2,error)}),errorCallback)}function getItem$1(key3,callback){var self2=this;key3=normalizeKey(key3);var promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){var dbInfo=self2._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT * FROM "+dbInfo.storeName+" WHERE key = ? LIMIT 1",[key3],(function(t2,results){var result=results.rows.length?results.rows.item(0).value:null;result&&(result=dbInfo.serializer.deserialize(result)),resolve(result)}),(function(t2,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}function iterate$1(iterator,callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){var dbInfo=self2._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT * FROM "+dbInfo.storeName,[],(function(t2,results){for(var rows=results.rows,length3=rows.length,i=0;i<length3;i++){var item=rows.item(i),result=item.value;if(result&&(result=dbInfo.serializer.deserialize(result)),void 0!==(result=iterator(result,item.key,i+1)))return void resolve(result)}resolve()}),(function(t2,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}function _setItem(key3,value,callback,retriesLeft){var self2=this;key3=normalizeKey(key3);var promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){void 0===value&&(value=null);var originalValue=value,dbInfo=self2._dbInfo;dbInfo.serializer.serialize(value,(function(value2,error){error?reject(error):dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"INSERT OR REPLACE INTO "+dbInfo.storeName+" (key, value) VALUES (?, ?)",[key3,value2],(function(){resolve(originalValue)}),(function(t2,error2){reject(error2)}))}),(function(sqlError){if(sqlError.code===sqlError.QUOTA_ERR){if(retriesLeft>0)return void resolve(_setItem.apply(self2,[key3,originalValue,callback,retriesLeft-1]));reject(sqlError)}}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}function setItem$1(key3,value,callback){return _setItem.apply(this,[key3,value,callback,1])}function removeItem$1(key3,callback){var self2=this;key3=normalizeKey(key3);var promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){var dbInfo=self2._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"DELETE FROM "+dbInfo.storeName+" WHERE key = ?",[key3],(function(){resolve()}),(function(t2,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}function clear$1(callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){var dbInfo=self2._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"DELETE FROM "+dbInfo.storeName,[],(function(){resolve()}),(function(t2,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}function length$1(callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){var dbInfo=self2._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT COUNT(key) as c FROM "+dbInfo.storeName,[],(function(t2,results){var result=results.rows.item(0).c;resolve(result)}),(function(t2,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}function key$1(n,callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){var dbInfo=self2._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT key FROM "+dbInfo.storeName+" WHERE id = ? LIMIT 1",[n+1],(function(t2,results){var result=results.rows.length?results.rows.item(0).key:null;resolve(result)}),(function(t2,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}function keys$1(callback){var self2=this,promise=new Promise$1((function(resolve,reject){self2.ready().then((function(){var dbInfo=self2._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT key FROM "+dbInfo.storeName,[],(function(t2,results){for(var keys3=[],i=0;i<results.rows.length;i++)keys3.push(results.rows.item(i).key);resolve(keys3)}),(function(t2,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}function getAllStoreNames(db){return new Promise$1((function(resolve,reject){db.transaction((function(t){t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(t2,results){for(var storeNames=[],i=0;i<results.rows.length;i++)storeNames.push(results.rows.item(i).name);resolve({db:db,storeNames:storeNames})}),(function(t2,error){reject(error)}))}),(function(sqlError){reject(sqlError)}))}))}function dropInstance$1(options,callback){callback=getCallback.apply(this,arguments);var currentConfig=this.config();(options="function"!=typeof options&&options||{}).name||(options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName);var promise,self2=this;return executeCallback(promise=options.name?new Promise$1((function(resolve){var db;db=options.name===currentConfig.name?self2._dbInfo.db:openDatabase(options.name,"","",0),options.storeName?resolve({db:db,storeNames:[options.storeName]}):resolve(getAllStoreNames(db))})).then((function(operationInfo){return new Promise$1((function(resolve,reject){operationInfo.db.transaction((function(t){function dropTable(storeName){return new Promise$1((function(resolve2,reject2){t.executeSql("DROP TABLE IF EXISTS "+storeName,[],(function(){resolve2()}),(function(t2,error){reject2(error)}))}))}for(var operations=[],i=0,len=operationInfo.storeNames.length;i<len;i++)operations.push(dropTable(operationInfo.storeNames[i]));Promise$1.all(operations).then((function(){resolve()})).catch((function(e){reject(e)}))}),(function(sqlError){reject(sqlError)}))}))})):Promise$1.reject("Invalid arguments"),callback),promise}var webSQLStorage={_driver:"webSQLStorage",_initStorage:_initStorage$1,_support:isWebSQLValid(),iterate:iterate$1,getItem:getItem$1,setItem:setItem$1,removeItem:removeItem$1,clear:clear$1,length:length$1,key:key$1,keys:keys$1,dropInstance:dropInstance$1};function isLocalStorageValid(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function _getKeyPrefix(options,defaultConfig){var keyPrefix=options.name+"/";return options.storeName!==defaultConfig.storeName&&(keyPrefix+=options.storeName+"/"),keyPrefix}function checkIfLocalStorageThrows(){var localStorageTestKey="_localforage_support_test";try{return localStorage.setItem(localStorageTestKey,!0),localStorage.removeItem(localStorageTestKey),!1}catch(e){return!0}}function _isLocalStorageUsable(){return!checkIfLocalStorageThrows()||localStorage.length>0}function _initStorage$2(options){var self2=this,dbInfo={};if(options)for(var i in options)dbInfo[i]=options[i];return dbInfo.keyPrefix=_getKeyPrefix(options,self2._defaultConfig),_isLocalStorageUsable()?(self2._dbInfo=dbInfo,dbInfo.serializer=localforageSerializer,Promise$1.resolve()):Promise$1.reject()}function clear$2(callback){var self2=this,promise=self2.ready().then((function(){for(var keyPrefix=self2._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var key3=localStorage.key(i);0===key3.indexOf(keyPrefix)&&localStorage.removeItem(key3)}}));return executeCallback(promise,callback),promise}function getItem$2(key3,callback){var self2=this;key3=normalizeKey(key3);var promise=self2.ready().then((function(){var dbInfo=self2._dbInfo,result=localStorage.getItem(dbInfo.keyPrefix+key3);return result&&(result=dbInfo.serializer.deserialize(result)),result}));return executeCallback(promise,callback),promise}function iterate$2(iterator,callback){var self2=this,promise=self2.ready().then((function(){for(var dbInfo=self2._dbInfo,keyPrefix=dbInfo.keyPrefix,keyPrefixLength=keyPrefix.length,length3=localStorage.length,iterationNumber=1,i=0;i<length3;i++){var key3=localStorage.key(i);if(0===key3.indexOf(keyPrefix)){var value=localStorage.getItem(key3);if(value&&(value=dbInfo.serializer.deserialize(value)),void 0!==(value=iterator(value,key3.substring(keyPrefixLength),iterationNumber++)))return value}}}));return executeCallback(promise,callback),promise}function key$2(n,callback){var self2=this,promise=self2.ready().then((function(){var result,dbInfo=self2._dbInfo;try{result=localStorage.key(n)}catch(error){result=null}return result&&(result=result.substring(dbInfo.keyPrefix.length)),result}));return executeCallback(promise,callback),promise}function keys$2(callback){var self2=this,promise=self2.ready().then((function(){for(var dbInfo=self2._dbInfo,length3=localStorage.length,keys3=[],i=0;i<length3;i++){var itemKey=localStorage.key(i);0===itemKey.indexOf(dbInfo.keyPrefix)&&keys3.push(itemKey.substring(dbInfo.keyPrefix.length))}return keys3}));return executeCallback(promise,callback),promise}function length$2(callback){var promise=this.keys().then((function(keys3){return keys3.length}));return executeCallback(promise,callback),promise}function removeItem$2(key3,callback){var self2=this;key3=normalizeKey(key3);var promise=self2.ready().then((function(){var dbInfo=self2._dbInfo;localStorage.removeItem(dbInfo.keyPrefix+key3)}));return executeCallback(promise,callback),promise}function setItem$2(key3,value,callback){var self2=this;key3=normalizeKey(key3);var promise=self2.ready().then((function(){void 0===value&&(value=null);var originalValue=value;return new Promise$1((function(resolve,reject){var dbInfo=self2._dbInfo;dbInfo.serializer.serialize(value,(function(value2,error){if(error)reject(error);else try{localStorage.setItem(dbInfo.keyPrefix+key3,value2),resolve(originalValue)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||reject(e),reject(e)}}))}))}));return executeCallback(promise,callback),promise}function dropInstance$2(options,callback){if(callback=getCallback.apply(this,arguments),!(options="function"!=typeof options&&options||{}).name){var currentConfig=this.config();options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName}var promise,self2=this;return executeCallback(promise=options.name?new Promise$1((function(resolve){options.storeName?resolve(_getKeyPrefix(options,self2._defaultConfig)):resolve(options.name+"/")})).then((function(keyPrefix){for(var i=localStorage.length-1;i>=0;i--){var key3=localStorage.key(i);0===key3.indexOf(keyPrefix)&&localStorage.removeItem(key3)}})):Promise$1.reject("Invalid arguments"),callback),promise}var localStorageWrapper={_driver:"localStorageWrapper",_initStorage:_initStorage$2,_support:isLocalStorageValid(),iterate:iterate$2,getItem:getItem$2,setItem:setItem$2,removeItem:removeItem$2,clear:clear$2,length:length$2,key:key$2,keys:keys$2,dropInstance:dropInstance$2},sameValue=function(x,y){return x===y||"number"==typeof x&&"number"==typeof y&&isNaN(x)&&isNaN(y)},includes=function(array,searchElement){for(var len=array.length,i=0;i<len;){if(sameValue(array[i],searchElement))return!0;i++}return!1},isArray=Array.isArray||function(arg){return"[object Array]"===Object.prototype.toString.call(arg)},DefinedDrivers={},DriverSupport={},DefaultDrivers={INDEXEDDB:asyncStorage,WEBSQL:webSQLStorage,LOCALSTORAGE:localStorageWrapper},DefaultDriverOrder=[DefaultDrivers.INDEXEDDB._driver,DefaultDrivers.WEBSQL._driver,DefaultDrivers.LOCALSTORAGE._driver],OptionalDriverMethods=["dropInstance"],LibraryMethods=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(OptionalDriverMethods),DefaultConfig={description:"",driver:DefaultDriverOrder.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function callWhenReady(localForageInstance,libraryMethod){localForageInstance[libraryMethod]=function(){var _args=arguments;return localForageInstance.ready().then((function(){return localForageInstance[libraryMethod].apply(localForageInstance,_args)}))}}function extend(){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(arg)for(var _key in arg)arg.hasOwnProperty(_key)&&(isArray(arg[_key])?arguments[0][_key]=arg[_key].slice():arguments[0][_key]=arg[_key])}return arguments[0]}var LocalForage=function(){function LocalForage2(options){for(var driverTypeKey in _classCallCheck(this,LocalForage2),DefaultDrivers)if(DefaultDrivers.hasOwnProperty(driverTypeKey)){var driver=DefaultDrivers[driverTypeKey],driverName=driver._driver;this[driverTypeKey]=driverName,DefinedDrivers[driverName]||this.defineDriver(driver)}this._defaultConfig=extend({},DefaultConfig),this._config=extend({},this._defaultConfig,options),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return LocalForage2.prototype.config=function(options){if("object"===(void 0===options?"undefined":_typeof(options))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in options){if("storeName"===i&&(options[i]=options[i].replace(/\W/g,"_")),"version"===i&&"number"!=typeof options[i])return new Error("Database version must be a number.");this._config[i]=options[i]}return!("driver"in options)||!options.driver||this.setDriver(this._config.driver)}return"string"==typeof options?this._config[options]:this._config},LocalForage2.prototype.defineDriver=function(driverObject,callback,errorCallback){var promise=new Promise$1((function(resolve,reject){try{var driverName=driverObject._driver,complianceError=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!driverObject._driver)return void reject(complianceError);for(var driverMethods=LibraryMethods.concat("_initStorage"),i=0,len=driverMethods.length;i<len;i++){var driverMethodName=driverMethods[i];if((!includes(OptionalDriverMethods,driverMethodName)||driverObject[driverMethodName])&&"function"!=typeof driverObject[driverMethodName])return void reject(complianceError)}var configureMissingMethods=function(){for(var methodNotImplementedFactory=function(methodName){return function(){var error=new Error("Method "+methodName+" is not implemented by the current driver"),promise2=Promise$1.reject(error);return executeCallback(promise2,arguments[arguments.length-1]),promise2}},_i=0,_len=OptionalDriverMethods.length;_i<_len;_i++){var optionalDriverMethod=OptionalDriverMethods[_i];driverObject[optionalDriverMethod]||(driverObject[optionalDriverMethod]=methodNotImplementedFactory(optionalDriverMethod))}};configureMissingMethods();var setDriverSupport=function(support){DefinedDrivers[driverName],DefinedDrivers[driverName]=driverObject,DriverSupport[driverName]=support,resolve()};"_support"in driverObject?driverObject._support&&"function"==typeof driverObject._support?driverObject._support().then(setDriverSupport,reject):setDriverSupport(!!driverObject._support):setDriverSupport(!0)}catch(e){reject(e)}}));return executeTwoCallbacks(promise,callback,errorCallback),promise},LocalForage2.prototype.driver=function(){return this._driver||null},LocalForage2.prototype.getDriver=function(driverName,callback,errorCallback){var getDriverPromise=DefinedDrivers[driverName]?Promise$1.resolve(DefinedDrivers[driverName]):Promise$1.reject(new Error("Driver not found."));return executeTwoCallbacks(getDriverPromise,callback,errorCallback),getDriverPromise},LocalForage2.prototype.getSerializer=function(callback){var serializerPromise=Promise$1.resolve(localforageSerializer);return executeTwoCallbacks(serializerPromise,callback),serializerPromise},LocalForage2.prototype.ready=function(callback){var self2=this,promise=self2._driverSet.then((function(){return null===self2._ready&&(self2._ready=self2._initDriver()),self2._ready}));return executeTwoCallbacks(promise,callback,callback),promise},LocalForage2.prototype.setDriver=function(drivers,callback,errorCallback){var self2=this;isArray(drivers)||(drivers=[drivers]);var supportedDrivers=this._getSupportedDrivers(drivers);function setDriverToConfig(){self2._config.driver=self2.driver()}function extendSelfWithDriver(driver){return self2._extend(driver),setDriverToConfig(),self2._ready=self2._initStorage(self2._config),self2._ready}function initDriver(supportedDrivers2){return function(){var currentDriverIndex=0;function driverPromiseLoop(){for(;currentDriverIndex<supportedDrivers2.length;){var driverName=supportedDrivers2[currentDriverIndex];return currentDriverIndex++,self2._dbInfo=null,self2._ready=null,self2.getDriver(driverName).then(extendSelfWithDriver).catch(driverPromiseLoop)}setDriverToConfig();var error=new Error("No available storage method found.");return self2._driverSet=Promise$1.reject(error),self2._driverSet}return driverPromiseLoop()}}var oldDriverSetDone=null!==this._driverSet?this._driverSet.catch((function(){return Promise$1.resolve()})):Promise$1.resolve();return this._driverSet=oldDriverSetDone.then((function(){var driverName=supportedDrivers[0];return self2._dbInfo=null,self2._ready=null,self2.getDriver(driverName).then((function(driver){self2._driver=driver._driver,setDriverToConfig(),self2._wrapLibraryMethodsWithReady(),self2._initDriver=initDriver(supportedDrivers)}))})).catch((function(){setDriverToConfig();var error=new Error("No available storage method found.");return self2._driverSet=Promise$1.reject(error),self2._driverSet})),executeTwoCallbacks(this._driverSet,callback,errorCallback),this._driverSet},LocalForage2.prototype.supports=function(driverName){return!!DriverSupport[driverName]},LocalForage2.prototype._extend=function(libraryMethodsAndProperties){extend(this,libraryMethodsAndProperties)},LocalForage2.prototype._getSupportedDrivers=function(drivers){for(var supportedDrivers=[],i=0,len=drivers.length;i<len;i++){var driverName=drivers[i];this.supports(driverName)&&supportedDrivers.push(driverName)}return supportedDrivers},LocalForage2.prototype._wrapLibraryMethodsWithReady=function(){for(var i=0,len=LibraryMethods.length;i<len;i++)callWhenReady(this,LibraryMethods[i])},LocalForage2.prototype.createInstance=function(options){return new LocalForage2(options)},LocalForage2}(),localforage_js=new LocalForage;module2.exports=localforage_js},{3:3}]},{},[4])(4);
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/localforage.config({driver:localforage.INDEXEDDB,description:"popup"});bridgePopupSandbox.on(StorehouseEvents.InitStorage.Name,(({options:options})=>(async _options=>{await localforage.ready()})())),bridgePopupSandbox.on(StorehouseEvents.GetItem.Name,(({key:key2,callback:callback})=>(async(key2,callback)=>localforage.getItem(key2,callback))(key2,callback))),bridgePopupSandbox.on(StorehouseEvents.SetItem.Name,(({key:key2,value:value,callback:callback})=>(async(key2,value,callback)=>localforage.setItem(key2,value,callback))(key2,value,callback))),bridgePopupSandbox.on(StorehouseEvents.RemoveItem.Name,(({key:key2,callback:callback})=>(async(key2,callback)=>{await localforage.removeItem(key2,callback)})(key2,callback))),bridgePopupSandbox.on(StorehouseEvents.Clear.Name,(({callback:callback})=>(async callback=>{await localforage.clear(callback)})(callback))),bridgePopupSandbox.on(StorehouseEvents.Length.Name,(({callback:callback})=>(async callback=>localforage.length(callback))(callback))),bridgePopupSandbox.on(StorehouseEvents.Key.Name,(({keyIndex:keyIndex,callback:callback})=>(async(keyIndex,callback)=>localforage.key(keyIndex,callback))(keyIndex,callback))),bridgePopupSandbox.on(StorehouseEvents.Keys.Name,(({callback:callback})=>(async callback=>localforage.keys(callback))(callback))),bridgePopupSandbox.on(StorehouseEvents.Iterate.Name,(({iteratee:iteratee,callback:callback})=>(async(iteratee,callback)=>localforage.iterate(iteratee,callback))(iteratee,callback)));const connection=connectionStore();bridgePopupBackground.on(ConnectionEvents.SetActive.Name,(({value:value})=>function(value){connection.setActive(value)}(value))),bridgePopupBackground.on(ConnectionEvents.SetHost.Name,(({value:value})=>function(value){connection.setHost(value)}(value)));const find=()=>(async()=>bridgePopupSandbox.emit(FavouritesEvents.Find.Name))(),remove=value=>(async value=>bridgePopupSandbox.emit(FavouritesEvents.Remove.Name,{value:value}))(value),save=value=>(async value=>bridgePopupSandbox.emit(FavouritesEvents.Save.Name,{value:value}))(value),findByRegionAndProtocol=(region,protocol)=>(async(region,protocol)=>bridgePopupSandbox.emit(FavouritesEvents.FindByRegionAndProtocol.Name,{region:region,protocol:protocol}))(region,protocol);bridgePopupBackground.on(FavouritesEvents.Find.Name,(()=>find())),bridgePopupBackground.on(FavouritesEvents.Remove.Name,(({value:value})=>remove(value))),bridgePopupBackground.on(FavouritesEvents.Save.Name,(({value:value})=>save(value))),bridgePopupBackground.on(FavouritesEvents.FindByRegionAndProtocol.Name,(({region:region,protocol:protocol})=>findByRegionAndProtocol(region,protocol)));
